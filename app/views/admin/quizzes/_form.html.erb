<%= form_with(model: [:admin, @quiz]) do |f| %>
  <% if @quiz.errors.any? %>
    <div class="alert alert-danger">
      <h2><%= pluralize(@quiz.errors.count, "lỗi") %> đã xảy ra:</h2>
      <ul>
        <% @quiz.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="card">
    <div class="card-body">
      <div class="mb-3">
        <%= f.label :title, "Tiêu đề Bài kiểm tra", class: "form-label" %>
        <%= f.text_field :title, class: "form-control", required: true %>
      </div>

      <div class="mb-3">
        <%= f.label :description, "Mô tả", class: "form-label" %>
        <%= f.text_area :description, rows: 3, class: "form-control" %>
      </div>

      <hr>
      <h4>Gắn vào Khóa học & Bài học</h4>

      <div class="row">
        <div class="col-md-6 mb-3">
          <%= f.label :course_id, "Khóa học (Bắt buộc)", class: "form-label" %>
          <%= f.collection_select :course_id, @courses, :id, :title,
                { prompt: "--- Chọn Khóa học ---" },
                { class: "form-select", required: true } %>
        </div>
        <div class="col-md-6 mb-3">
          <%= f.label :lesson_id, "Bài học (Bắt buộc)", class: "form-label" %>
          <%= f.collection_select :lesson_id, @lessons, :id, :title,
                { prompt: "--- Chọn Bài học ---" },
                { class: "form-select", required: true } %>
          <small class="text-muted">Lưu ý: Bạn nên chọn bài học thuộc khóa học ở trên.</small>
        </div>
      </div>

      <hr>
      <h4>Cài đặt</h4>

      <div class="row">
        <div class="col-md-4 mb-3">
          <%= f.label :pass_score, "Điểm đậu (%)", class: "form-label" %>
          <%= f.number_field :pass_score, value: 70, class: "form-control" %>
        </div>
        <div class="col-md-4 mb-3">
          <%= f.label :time_limit, "Thời gian giới hạn (phút)", class: "form-label" %>
          <%= f.number_field :time_limit, class: "form-control", placeholder: "Bỏ trống nếu không giới hạn" %>
        </div>
         <div class="col-md-4 mb-3">
          <%= f.label :total_questions, "Số câu hỏi (dùng cho random)", class: "form-label" %>
          <%= f.number_field :total_questions, value: 10, class: "form-control" %>
        </div>
      </div>
      <div class="mb-3 form-check">
        <%= f.check_box :random_mode, class: "form-check-input" %>
        <%= f.label :random_mode, "Trộn câu hỏi ngẫu nhiên?", class: "form-check-label" %>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <%= f.submit "Lưu Bài kiểm tra", class: "btn btn-primary" %>
    <%= link_to "Hủy", admin_quizzes_path, class: "btn btn-secondary" %>
  </div>
<% end %>
